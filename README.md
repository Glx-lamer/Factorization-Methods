# Factorization Methods
> *Lab 3 Number-theoretic methods in cryptography (Peter the Great St. Petersburg Polytechnic University)*

## Intro
Факторизация - одна из самых хорошо известных задач теории чисел. Для чисел большой разрядности разложение на множители считают сложным, что делает его привлекательным для применения в криптографии для построения криптосистем с открытым ключом.
Далее рассмотрены некоторые методы разложения.

---

## Dixon's Method {#DixonMethod}
В 1921 г. Джон Диксон опубликовал разработанный им метод факторизации, использующий идеи Мориса Крайчика [^1]

[^1]: Обобщая теорему Ферма, Морис Крайчик предложил вместо пар чисел, удовлетворяющих уравнению $x^2 - y^2 = n$, искать пары чисел, удовлетворяющих более общему сравнению $x^2 \equiv y^2 \pmod n$.

**Алгоритм метода:**
1. Составляется факторная база 
$B = \{-1, p_1, p_2, \ldots, p_h\}$,
где $\forall h:$ $p_h$ - простое число меньшее $P = \sqrt{exp(\sqrt{\ln{n} \cdot \ln{\ln{n}}})}$.
2. 
    - Найти $h+2$ целых чисел $s_i$, для каждого из которых абсолютно наименьший вычет является $B$-гладким:

        $s_i^2 \pmod n = \prod_{j=0}^{h}p_j^{\alpha_j(s_i)}$.
    
    - Каждому числу $s_i$ сопоставить вектор показателей простых чисел из факторной базы $(\alpha_0(s_i), \alpha_1(s_i), \ldots, \alpha_h(s_i))$ и вектор $e_i = (e_1^{(i)}, e_2^{(i)}, \ldots, e_h^{(i)})$, где $e_j^{(i)} \equiv \alpha_j(s_i) \pmod 2$.
3. Найти такое непустое множество $K \sube \{1, 2, \ldots, h+1\}$, что $\oplus_{k \in K}e_k=0$.
4. 
    - Вычислить:
$s \equiv \prod_{k \in K} s_k \pmod n$;
$t \equiv \prod_{i=1}^h p_i^{\frac{1}{2}\sum_{k \in K} \alpha_i(s_k)}$.
    - Проверить:
    $s^2 \equiv t^2 \pmod n$.
5. 
    - Если $s \not \equiv \pm t \pmod n$:
        результат - $GCD(s-t, n)$.
    - В противном случае:
    вернуться к выбору $K$.


## Quadratic Sieve Method
Метод квадратичного решета - способ выбора чисел $s_i$ в [методе Диксона](#DixonMethod), разработанный Карлом Померанцем в 1981 году.

**Алгоритм метода:**
1. Из факторной базы $B$ выбираем только те $p$, по модулю которых $n$ - квадратичный вычет.
2. Решаем сравнения:
$f(x) = (x+[\sqrt n])^2 \equiv n \pmod {p_i}$.
3. 
    - Рассматриваем $x$ в некотором промежутке $[-M, M]$, где $M = B^3$.
    - Каждому $x$ сопоставляем значение $\ln{|f(x)|}$.
    - Для $x$, удовлетворящих сравнениям из п.2. из соответствующего значения логарифма вычитаем $\ln p$.
4. Из таблицы логарифмов выбираем наименьшие и проверяем соответствующие $x$ на $B$-гладкость, пока не наберем $h+2$ значения.
5. Продолжаем по алгоритму метода Диксона.